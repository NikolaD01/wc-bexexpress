var d=Object.defineProperty;var u=(n,e,t)=>e in n?d(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var r=(n,e,t)=>u(n,typeof e!="symbol"?e+"":e,t);import{A as c}from"./assets/ajax.service-CvjR3zXt.js";const i={async createShipment(n,e){return await new c(n).post("create_order",e)},async getLabel(n,e){return await new c(n).post("get_label",e)}};class l{constructor(e,t){r(this,"ajaxUrl");r(this,"button");this.ajaxUrl=e;const a=document.getElementById(t);if(!a){console.error(`Button with ID ${t} not found.`);return}this.button=a,this.init()}init(){this.button.addEventListener("click",e=>{e.preventDefault(),this.get()})}async get(){try{const e=this.getData(),t=await i.getLabel(this.ajaxUrl,e);if(t.success){const a=t.data.fileUrl;if(a){const o=document.createElement("a");o.href=a,o.download="label.pdf",document.body.appendChild(o),o.click(),document.body.removeChild(o)}}else console.error("Failed to create order:",t.data)}catch(e){console.error(e)}}getData(){const e=document.getElementById("post_ID");return{post_id:e?e.value:null}}}class h{constructor(e,t){r(this,"ajaxUrl");r(this,"button");this.ajaxUrl=e;const a=document.getElementById(t);if(!a){console.error(`Button with ID ${t} not found.`);return}this.button=a,this.init()}init(){this.button.addEventListener("click",e=>{e.preventDefault(),this.send()})}async send(){try{const e=this.getData(),t=await i.createShipment(this.ajaxUrl,e);t.success&&this.replaceButton(),console.log("Order created successfully:",t)}catch(e){console.error("Failed to create order:",e)}}getData(){const e=document.getElementById("post_ID"),t=e?e.value:null,a=document.getElementById("bex_order_meta_box"),o={};return a?a.querySelectorAll('input[name^="bex"]').forEach(s=>{s.name&&(o[s.name]=s.value)}):console.error("Container with ID 'bex_order_meta_box' not found."),{post_id:t,meta_data:o}}replaceButton(){var t;const e=document.createElement("button");e.className="button",e.id="bexCreateLabel",e.textContent="Create Label",(t=this.button.parentNode)==null||t.replaceChild(e,this.button),new l(this.ajaxUrl,"bexCreateLabel")}}const b=()=>{const n=window.admin_globals.ajax_url;try{new h(n,"bexCreateShipment"),new l(n,"bexCreateLabel")}catch{}};document.addEventListener("DOMContentLoaded",b);
