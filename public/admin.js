var l=Object.defineProperty;var d=(o,e,t)=>e in o?l(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t;var r=(o,e,t)=>d(o,typeof e!="symbol"?e+"":e,t);import{A as c}from"./assets/ajax.service-CvjR3zXt.js";class i{constructor(e,t){r(this,"ajaxService");r(this,"button");this.ajaxService=new c(e);const n=document.getElementById(t);if(!n){console.error(`Button with ID ${t} not found.`);return}this.button=n,this.init()}init(){this.button.addEventListener("click",e=>{e.preventDefault(),this.get()})}async get(){try{const e=this.getData(),t=await this.ajaxService.post("get_label",e);if(t.success){const n=t.data.fileUrl;if(n){const a=document.createElement("a");a.href=n,a.download="label.pdf",document.body.appendChild(a),a.click(),document.body.removeChild(a)}}else console.error("Failed to create order:",t.data)}catch(e){console.error(e)}}getData(){const e=document.getElementById("post_ID");return{post_id:e?e.value:null}}}class u{constructor(e,t){r(this,"ajaxService");r(this,"button");r(this,"ajaxUrl");this.ajaxUrl=e,this.ajaxService=new c(this.ajaxUrl);const n=document.getElementById(t);if(!n){console.error(`Button with ID ${t} not found.`);return}this.button=n,this.init()}init(){this.button.addEventListener("click",e=>{e.preventDefault(),this.send()})}async send(){try{const e=this.getData(),t=await this.ajaxService.post("create_order",e);t.success&&this.replaceButton(),console.log("Order created successfully:",t)}catch(e){console.error("Failed to create order:",e)}}getData(){const e=document.getElementById("post_ID"),t=e?e.value:null,n=document.getElementById("bex_order_meta_box"),a={};return n?n.querySelectorAll('input[name^="bex"]').forEach(s=>{s.name&&(a[s.name]=s.value)}):console.error("Container with ID 'bex_order_meta_box' not found."),{post_id:t,meta_data:a}}replaceButton(){var t;const e=document.createElement("button");e.className="button",e.id="bexCreateLabel",e.textContent="Create Label",new i(this.ajaxUrl,"bexCreateLabel"),e.addEventListener("click",n=>{n.preventDefault(),console.log("Create Label button clicked.")}),(t=this.button.parentNode)==null||t.replaceChild(e,this.button)}}const h=()=>{const o=window.admin_globals.ajax_url;try{new u(o,"bexCreateShipment"),new i(o,"bexCreateLabel")}catch{}};document.addEventListener("DOMContentLoaded",h);
